@import "tailwindcss";

/* ============================================
   Flum — Neon Pop × Blue River テーマ
   背景=川（青）、コンテンツ=流れる情報（ネオンポップ）
   ============================================ */

/* --- 共通アクセント（テーマ問わず固定） --- */
:root {
  --accent-pink: #ff3b9a;
  --accent-pink-light: #ff6bc1;
  --accent-purple: #a855f7;
  --accent-yellow: #ffdd00;
  --accent-cyan: #00e5ff;

  /* 鮮度ステージ（アクセント依存、テーマ問わず固定） */
  --fresh-color: #ff3b9a;
  --fresh-glow: 0 0 10px #ff3b9a, 0 0 4px #ff3b9a;
  --recent-color: #ff6bc1;
  --recent-glow: 0 0 6px rgba(255, 107, 193, 0.5);
  --aging-color: #ffdd00;
  --aging-glow: 0 0 6px rgba(255, 221, 0, 0.4);
}

/* --- Dark: ネオンポップの舞台（近黒 + ビビッドアクセント） --- */
:root,
[data-theme="dark"] {
  --river-deep: #0a0a10;
  --river-bg: #101018;
  --river-surface: #18182a;
  --river-border: #2a2a40;

  --text-primary: #e8e8f0;
  --text-secondary: #8888a8;
  --text-muted: #606078;
  --text-faded: #404058;

  --old-color: #1e3a58;
  --stale-color: #0f1f38;

  --glass-bg: rgba(0, 0, 0, 0.95);
  --glass-overlay: rgba(0, 0, 0, 0.50);

  --background: var(--river-bg);
  --foreground: var(--text-primary);
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);

  /* Tailwind カスタムカラー */
  --color-river-deep: var(--river-deep);
  --color-river-bg: var(--river-bg);
  --color-river-surface: var(--river-surface);
  --color-river-border: var(--river-border);
  --color-neon-pink: var(--accent-pink);
  --color-neon-pink-light: var(--accent-pink-light);
  --color-neon-purple: var(--accent-purple);
  --color-neon-yellow: var(--accent-yellow);
  --color-neon-cyan: var(--accent-cyan);

  /* インタラクショントークン */
  --color-int-accent: var(--accent-cyan);   /* Secondary/bordered ホバーアクセント */
  --color-int-danger: #f87171;               /* Destructive ホバー */

  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: Arial, Helvetica, sans-serif;
}


/* --- カラードレイン ---
   Splatoon: 彩度剥奪 = 弱体化
   Persona 5: 彩度 + 色温度シフト = 状態変化
   非対称トランジション: ゆっくり色を失い、瞬時に復活（カラーフラッシュ） */

/* 色を失う方向: ゆっくり（ページ表示時） */
[data-decay="true"] {
  opacity: var(--decay-opacity, 1);
  transition: filter 1.2s ease-out, opacity 1.2s ease-out;
}

/* ホバー / タップ: 瞬時復帰（0.08s）= Splatoon の「色が戻る」快感
   :hover はデスクトップ、:active はモバイルタップ */
[data-decay="true"]:hover,
[data-decay="true"]:active {
  filter: none !important;
  opacity: 1 !important;
  transition: filter 0.08s ease-out, opacity 0.08s ease-out;
}

/* モバイル: ホバーなし端末では filter 無効・opacity のみで鮮度表現 */
@media (hover: none) {
  [data-decay="true"] {
    filter: none !important;
    opacity: max(var(--decay-opacity, 1), 0.6);
  }
}

/* --- フィードカード入場アニメーション ---
   日本アニメ式「ポンッ」: 浮上 → オーバーシュート → 着地 + ソフトグロー
   参考: ドーナドーナのポップ感 + 日本ソシャゲの「出た！」演出
   原則: かわいい = 小振り・短尺・1回バウンス（グリッチやclip-pathは西洋的なので不使用） */

[data-card-enter] {
  --pop-duration: 0.35s;
  --pop-stagger: 120ms;

  animation: card-pop var(--pop-duration) cubic-bezier(0.34, 1.56, 0.64, 1) both;
  animation-delay: var(--enter-delay, 0ms);
}

/* fresh + 入場: pop → pulse を直列で再生（animation 競合を回避）
   delay = 入場遅延 + pop 所要時間。pop が終わってから pulse が始まる。 */
[data-card-enter][data-freshness="fresh"] {
  animation:
    card-pop var(--pop-duration) cubic-bezier(0.34, 1.56, 0.64, 1) both,
    fresh-pulse 1.5s ease-in-out calc(var(--enter-delay, 0ms) + var(--pop-duration)) 2;
}

@keyframes card-pop {
  0%   { opacity: 0; transform: scale(0.92) translateY(8px); }
  50%  { opacity: 1; transform: scale(1.03) translateY(-2px); }
  75%  { transform: scale(0.998); }
  100% { opacity: 1; transform: none; }
}

/* --- fresh パルス（Hi-Fi Rush 式: パルス = 生きてる感） ---
   < 1時間の記事だけ、ピンクの光が2回パルス。「さっき届いたよ」のシグナル
   入場アニメーションなしの場合はこちらが適用される */
[data-freshness="fresh"]:not([data-card-enter]) {
  animation: fresh-pulse 1.5s ease-in-out 2;
}

@keyframes fresh-pulse {
  0%, 100% { box-shadow: 0 0 0 0 rgba(255, 59, 154, 0); }
  50% { box-shadow: 0 0 8px 4px rgba(255, 59, 154, 0.3); }
}

/* --- グリッチエフェクト（stale: 18-24h、消失直前） --- */
.glitch-text {
  animation: glitch 3.5s infinite;
}

@keyframes glitch {
  0%, 100% { text-shadow: none; transform: none; }
  /* 1回目: ガタッ */
  24% { text-shadow: none; transform: none; }
  25% {
    text-shadow: 3px 0 var(--accent-cyan), -3px 0 var(--accent-pink);
    transform: translateX(-3px) skewX(-1deg);
  }
  27% { text-shadow: none; transform: translateX(1px); }
  28% { transform: none; }
  /* 2回目: ビリッ（連打感） */
  30% {
    text-shadow: -2px 0 var(--accent-pink), 2px 0 var(--accent-cyan);
    transform: translateX(2px) skewX(0.5deg);
  }
  32% { text-shadow: none; transform: none; }
}

/* アクセシビリティ: 動き抑制設定 */
@media (prefers-reduced-motion: reduce) {
  .glitch-text,
  [data-freshness="fresh"],
  [data-card-enter] {
    animation: none !important;
  }
}

/* ============================================
   デフォルト背景デコ — 夜の川（River at Night）
   Flum = Flume（水路）。星が川面に映り、光が水面で揺れる。
   ============================================ */

/* ✦ 星空 — 3層のドットグリッドで奥行き（Moiré 効果） */
.river-stars-far {
  background-image:
    radial-gradient(circle, rgba(200, 210, 255, 0.8) 0.5px, transparent 0.5px);
  background-size: 11px 13px;
  opacity: 0.04;
}

.river-stars-mid {
  background-image:
    radial-gradient(circle, rgba(220, 230, 255, 0.9) 0.8px, transparent 0.8px);
  background-size: 29px 31px;
  opacity: 0.06;
}

.river-stars-near {
  background-image:
    radial-gradient(circle, white 1.2px, transparent 1.2px);
  background-size: 67px 71px;
  opacity: 0.07;
}

/* 星空は上半分に集中（川面は下半分） */
.river-sky {
  mask-image: linear-gradient(to bottom, black 30%, transparent 65%);
  -webkit-mask-image: linear-gradient(to bottom, black 30%, transparent 65%);
}

/* ～ 水面の反射 — 星のミラーリング（強ぼかし + 横引き伸ばし）
   blur(6px) + scaleX(3) でドットが横の光筋に滲む = 水面感 */
.river-reflection {
  mask-image: linear-gradient(to top, black 20%, transparent 55%);
  -webkit-mask-image: linear-gradient(to top, black 20%, transparent 55%);
  filter: blur(6px);
  transform: scaleX(3) scaleY(-1);
  transform-origin: center 60%;
  opacity: 1.2;
}

/* ◉ 揺らめき — 水面で光が踊る（呼吸パルス） */
.river-shimmer {
  position: absolute;
  border-radius: 50%;
  animation: shimmer-pulse 4s ease-in-out infinite;
}

.river-shimmer-1 {
  width: 120px; height: 6px;
  bottom: 30%; left: 15%;
  background: radial-gradient(ellipse, var(--accent-pink), transparent 70%);
  opacity: 0.12;
}

.river-shimmer-2 {
  width: 80px; height: 4px;
  bottom: 38%; right: 20%;
  background: radial-gradient(ellipse, var(--accent-cyan), transparent 70%);
  opacity: 0.10;
  animation-delay: -1.5s;
}

.river-shimmer-3 {
  width: 60px; height: 3px;
  bottom: 25%; left: 55%;
  background: radial-gradient(ellipse, white, transparent 70%);
  opacity: 0.08;
  animation-delay: -3s;
}

.river-shimmer-4 {
  width: 100px; height: 5px;
  bottom: 42%; left: 35%;
  background: radial-gradient(ellipse, var(--accent-purple), transparent 70%);
  opacity: 0.09;
  animation-delay: -2.2s;
}

@keyframes shimmer-pulse {
  0%, 100% { transform: scaleX(1); opacity: var(--shimmer-base, 0.1); }
  50% { transform: scaleX(1.4); opacity: calc(var(--shimmer-base, 0.1) * 1.8); }
}

/* ─ 水流ライン — 水平に漂う光の筋（情報の流れ） */
.river-flow {
  position: absolute;
  height: 1px;
  animation: flow-drift 20s linear infinite;
}

.river-flow-1 {
  width: 40%;
  bottom: 35%;
  left: -10%;
  background: linear-gradient(90deg, transparent, var(--accent-cyan), transparent);
  opacity: 0.08;
}

.river-flow-2 {
  width: 30%;
  bottom: 28%;
  left: -5%;
  background: linear-gradient(90deg, transparent, var(--accent-pink), transparent);
  opacity: 0.06;
  animation-delay: -8s;
  animation-duration: 25s;
}

.river-flow-3 {
  width: 50%;
  bottom: 44%;
  left: -15%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.5), transparent);
  opacity: 0.05;
  animation-delay: -14s;
  animation-duration: 30s;
}

@keyframes flow-drift {
  from { transform: translateX(0); }
  to { transform: translateX(calc(100vw + 20%)); }
}

/* ◎ 環境光 — 川面に映る街の灯り */
.river-glow {
  position: absolute;
  border-radius: 50%;
  filter: blur(60px);
}

.river-glow-pink {
  width: 300px; height: 200px;
  bottom: 10%; right: 5%;
  background: var(--accent-pink);
  opacity: 0.04;
}

.river-glow-cyan {
  width: 250px; height: 180px;
  top: 15%; left: 5%;
  background: var(--accent-cyan);
  opacity: 0.03;
}

/* ── 水平線 — 空と水面の境界 */
.river-horizon {
  position: absolute;
  top: 55%;
  left: 0;
  right: 0;
  height: 1px;
  background: linear-gradient(90deg,
    transparent 5%,
    rgba(200, 210, 255, 0.10) 30%,
    rgba(200, 210, 255, 0.15) 50%,
    rgba(200, 210, 255, 0.10) 70%,
    transparent 95%
  );
}

@media (prefers-reduced-motion: reduce) {
  .river-shimmer,
  .river-flow { animation: none; }
  .river-shimmer { opacity: 0.08; }
}

